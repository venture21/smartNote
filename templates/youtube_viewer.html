<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎬 영상/오디오 검색 엔진 v0.3</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🎬</text></svg>">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- YouTube IFrame Player API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <!-- Tabs and Components CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tabs.css') }}">
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <header>
            <h1><span class="film-icon">🎬</span> 영상/오디오 검색 엔진 v0.2</h1>
        </header>

        <!-- 탭 네비게이션 -->
        <div class="tabs">
            <button class="tab-button active" data-tab="video-tab">
                🎬 영상 검색
            </button>
            <button class="tab-button" data-tab="audio-tab">
                🎵 오디오 검색
            </button>
            <button class="tab-button" data-tab="retriever-tab">
                🔍 Retriever 검색
            </button>
            <button class="tab-button" data-tab="ask-content-tab">
                💬 내용 질문
            </button>
            <button class="tab-button" data-tab="data-management-tab">
                🗂️ 데이터 관리
            </button>
        </div>

        <!-- ========== 영상 검색 탭 ========== -->
        <div id="video-tab" class="tab-content active">
            <!-- YouTube URL 입력 섹션 -->
            <section class="upload-section" id="videoUploadSection">
                <div class="upload-card">
                    <h2>🔗 YouTube URL 입력</h2>
                    <p class="description">YouTube 영상 URL을 입력하면 자동으로 다운로드하여 회의록을 생성합니다</p>

                    <form id="youtubeForm">
                        <div class="form-group">
                            <label for="youtubeUrl">YouTube URL</label>
                            <input
                                type="text"
                                id="youtubeUrl"
                                name="youtube_url"
                                placeholder="https://www.youtube.com/watch?v=..."
                                required
                                style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem;"
                            >
                        </div>

                        <div class="form-group" style="margin-top: 16px;">
                            <label for="videoChunkDuration">🔪 오디오 분할 시간 (긴 파일 처리용)</label>
                            <select
                                id="videoChunkDuration"
                                name="chunk_duration"
                                style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem; background: white;"
                            >
                                <option value="10">10분 (짧은 청크, 안정성 높음)</option>
                                <option value="20">20분 (균형)</option>
                                <option value="30" selected>30분 (긴 청크, 빠름)</option>
                            </select>
                            <p style="font-size: 0.85rem; color: var(--text-muted); margin-top: 8px;">
                                💡 긴 오디오 파일은 선택한 시간만큼 분할하여 처리합니다. 짧을수록 안정적이지만 처리 시간이 늘어납니다.
                            </p>
                        </div>

                        <button type="submit" class="btn-primary" id="videoSubmitBtn">
                            <span class="btn-icon">🎤</span>
                            <span id="videoSubmitBtnText">영상 처리 시작</span>
                        </button>
                    </form>

                    <div id="videoUploadStatus" class="upload-status"></div>

                    <!-- 진행 상황 표시 -->
                    <div id="videoProgressSection" class="progress-section" style="display: none;">
                        <div class="progress-item">
                            <div class="progress-label">
                                <span>🎵 오디오 다운로드 & MP3 변환</span>
                                <span id="videoDownloadProgress">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div id="videoDownloadProgressBar" class="progress-fill"></div>
                            </div>
                            <div id="videoDownloadMessage" class="progress-message">대기 중...</div>
                        </div>

                        <div class="progress-item">
                            <div class="progress-label">
                                <span>🎤 오디오에서 텍스트 추출(STT)</span>
                                <span id="videoSttProgress">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div id="videoSttProgressBar" class="progress-fill"></div>
                            </div>
                            <div id="videoSttMessage" class="progress-message">대기 중...</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 영상 뷰어 섹션 -->
            <section class="viewer-section" id="videoViewerSection" style="display: none;">
                <!-- 영상 정보 -->
                <div class="audio-player-container">
                    <div class="audio-header">
                        <h2>📹 영상 정보</h2>
                        <button id="changeVideoBtn" class="btn-change-file" title="다른 영상 처리">
                            🔗 URL 변경
                        </button>
                    </div>
                    <div class="video-info" id="videoInfo"></div>
                </div>

                <!-- 메인 레이아웃: 플레이어+요약/채팅 (왼쪽 67%) | 회의록 (오른쪽 33%) -->
                <div class="main-layout-grid">
                    <!-- 왼쪽 영역: YouTube 플레이어 + 요약/채팅 -->
                    <div class="left-section">
                        <!-- YouTube 플레이어 -->
                        <div class="youtube-player-container">
                            <div class="audio-header">
                                <h2>🎬 YouTube 플레이어</h2>
                            </div>
                            <div id="youtubePlayerWrapper">
                                <div id="youtubePlayer"></div>
                            </div>
                            <div class="player-info">
                                <span id="videoCurrentTime">00:00</span> / <span id="videoDuration">00:00</span>
                            </div>
                            <div class="volume-control">
                                <label for="youtubeVolume">🔊 YouTube 볼륨:</label>
                                <input type="range" id="youtubeVolume" min="0" max="100" value="20" class="volume-slider">
                                <span id="youtubeVolumeValue">20%</span>
                            </div>
                        </div>

                        <!-- 제목 입력 영역 -->
                        <div class="audio-player-container" style="margin-top: 10px;">
                            <label for="videoTitleInput" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">
                                📝 제목 입력 (회의록과 요약을 VectorStore에 저장할 때 메타데이터로 추가됩니다)
                            </label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input
                                    type="text"
                                    id="videoTitleInput"
                                    placeholder="회의록 제목을 입력하세요..."
                                    style="flex: 1; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem;"
                                >
                                <button id="saveVideoTitleBtn" class="btn-primary" style="flex: 0 0 auto; width: auto !important; padding: 10px 16px; white-space: nowrap; font-size: 0.9rem;">
                                    저장
                                </button>
                            </div>
                            <div id="videoTitleStatus" style="margin-top: 8px; font-size: 0.9rem;"></div>
                        </div>

                        <!-- 요약 및 채팅 영역 -->
                        <div class="bottom-content-grid">
                            <!-- 요약 섹션 -->
                            <div class="summary-container">
                                <div class="summary-header">
                                    <h2>📋 소주제별 요약</h2>
                                    <button id="videoGenerateSummaryBtn" class="btn-primary">요약 생성</button>
                                </div>
                                <div id="videoSummaryContent" class="summary-content">
                                    <p class="summary-placeholder">요약 생성 버튼을 클릭하세요</p>
                                </div>
                                <div id="videoSummaryLoading" class="loading-indicator" style="display: none;">
                                    <span class="spinner"></span> 요약 생성 중...
                                </div>
                            </div>

                            <!-- 채팅 섹션 -->
                            <div class="chat-container">
                                <div class="chat-header">
                                    <h2>💬 AI 채팅</h2>
                                    <button id="videoClearChatBtn" class="btn-clear-chat" title="대화 초기화">🗑️</button>
                                </div>
                                <div id="videoChatMessages" class="chat-messages">
                                    <div class="chat-welcome">
                                        회의록 내용에 대해 질문해보세요!
                                    </div>
                                </div>
                                <div class="chat-input-container">
                                    <textarea
                                        id="videoChatInput"
                                        class="chat-input"
                                        placeholder="질문을 입력하세요..."
                                        rows="2"
                                    ></textarea>
                                    <button id="videoSendChatBtn" class="btn-send-chat">
                                        <img src="{{ url_for('static', filename='images/chat_icon.png') }}?v=2" alt="Send" class="btn-icon-img">
                                    </button>
                                </div>
                                <div id="videoChatLoading" class="loading-indicator" style="display: none;">
                                    <span class="spinner"></span> 응답 생성 중...
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 오른쪽 영역: 회의록 (33%) -->
                    <div class="right-section">
                        <div class="transcript-container">
                            <div class="transcript-header">
                                <h2>📝 회의록</h2>
                                <div class="controls" style="flex-direction: column; align-items: flex-start; gap: 8px;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <span id="videoOriginalLanguage" style="padding: 6px 12px; background: rgba(var(--primary-rgb), 0.1); border-radius: 6px; font-size: 0.9rem; color: var(--primary-color); font-weight: 600;"></span>
                                        <select id="videoLanguageSelect" class="language-select" style="padding: 8px 12px; border-radius: 6px; border: 2px solid var(--border-color); background: var(--bg-primary); color: var(--text-primary);">
                                            <option value="original">원본</option>
                                            <option value="en">English</option>
                                            <option value="ja">日本語</option>
                                            <option value="de">Deutsch</option>
                                            <option value="ko">한국어</option>
                                        </select>
                                        <button id="videoTranslateBtn" class="btn-secondary" style="padding: 8px 16px;">번역</button>
                                        <button id="videoGenerateTtsBtn" class="btn-primary" style="padding: 8px 16px;">오디오 생성</button>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <button id="videoAutoScrollToggle" class="btn-secondary active">자동 스크롤: ON</button>
                                        <span id="videoSegmentInfo" style="font-size: 0.9rem; color: var(--text-secondary);">총 0개 세그먼트</span>
                                    </div>
                                </div>
                            </div>
                            <div id="videoTranscriptContent" class="transcript-content"></div>
                        </div>
                    </div>
                </div>

                <!-- VectorStore 저장 버튼 -->
                <div class="audio-player-container" style="margin-top: 20px;">
                    <div style="text-align: center; padding: 20px; background: var(--bg-secondary); border-radius: 12px; border: 2px solid var(--primary-color);">
                        <h3 style="margin-bottom: 16px; color: var(--primary-color);">📦 VectorStore 저장</h3>
                        <p style="margin-bottom: 16px; color: var(--text-muted); font-size: 0.9rem;">
                            제목과 요약을 입력한 후 아래 버튼을 클릭하여 VectorStore에 저장하세요.
                        </p>
                        <button id="saveVideoToVectorstoreBtn" class="btn-primary" style="padding: 16px 32px; font-size: 1.1rem;">
                            💾 VectorStore에 저장
                        </button>
                        <div id="videoVectorstoreSaveStatus" style="margin-top: 12px; font-size: 0.9rem;"></div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ========== 오디오 검색 탭 ========== -->
        <div id="audio-tab" class="tab-content">
            <!-- 오디오 파일 업로드 섹션 -->
            <section class="upload-section" id="audioUploadSection">
                <div class="upload-card">
                    <h2>📁 오디오 파일 업로드</h2>
                    <p class="description">오디오 파일을 업로드하면 자동으로 회의록을 생성합니다</p>

                    <form id="audioForm">
                        <!-- 파일 업로드 영역 -->
                        <div class="file-upload-area" id="fileUploadArea">
                            <div class="file-upload-icon">📁</div>
                            <div class="file-upload-text">파일을 드래그하거나 클릭하여 선택하세요</div>
                            <div class="file-upload-hint">지원 형식: MP3, WAV, M4A, FLAC, OGG (최대 500MB)</div>
                            <input type="file" id="audioFileInput" accept="audio/*,video/*" style="display: none;">
                        </div>

                        <!-- 선택된 파일 정보 -->
                        <div class="file-info" id="fileInfo">
                            <div class="file-info-item">
                                <strong>파일명:</strong>
                                <span id="fileName">-</span>
                            </div>
                            <div class="file-info-item">
                                <strong>파일 크기:</strong>
                                <span id="fileSize">-</span>
                            </div>
                            <div class="file-info-item">
                                <strong>파일 형식:</strong>
                                <span id="fileType">-</span>
                            </div>
                        </div>

                        <div class="form-group" style="margin-top: 16px;">
                            <label for="audioChunkDuration">🔪 오디오 분할 시간 (긴 파일 처리용)</label>
                            <select
                                id="audioChunkDuration"
                                name="chunk_duration"
                                style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem; background: white;"
                            >
                                <option value="10">10분 (짧은 청크, 안정성 높음)</option>
                                <option value="20">20분 (균형)</option>
                                <option value="30" selected>30분 (긴 청크, 빠름)</option>
                            </select>
                            <p style="font-size: 0.85rem; color: var(--text-muted); margin-top: 8px;">
                                💡 긴 오디오 파일은 선택한 시간만큼 분할하여 처리합니다. 짧을수록 안정적이지만 처리 시간이 늘어납니다.
                            </p>
                        </div>

                        <button type="submit" class="btn-primary" id="audioSubmitBtn" disabled>
                            <span class="btn-icon">🎤</span>
                            오디오 처리 시작
                        </button>
                    </form>

                    <div id="audioUploadStatus" class="upload-status"></div>

                    <!-- 진행 상황 표시 -->
                    <div id="audioProgressSection" class="progress-section" style="display: none;">
                        <div class="progress-item">
                            <div class="progress-label">
                                <span>🎤 오디오에서 텍스트 추출(STT)</span>
                                <span id="audioSttProgress">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div id="audioSttProgressBar" class="progress-fill"></div>
                            </div>
                            <div id="audioSttMessage" class="progress-message">대기 중...</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 오디오 뷰어 섹션 -->
            <section class="viewer-section" id="audioViewerSection" style="display: none;">
                <!-- 오디오 정보 -->
                <div class="audio-player-container">
                    <div class="audio-header">
                        <h2>🎵 오디오 정보</h2>
                        <button id="changeAudioBtn" class="btn-change-file" title="다른 오디오 업로드">
                            📁 파일 변경
                        </button>
                    </div>
                    <div class="video-info" id="audioContentInfo"></div>
                </div>

                <!-- 오디오 플레이어 -->
                <div class="audio-player-container">
                    <div class="audio-header">
                        <h2>🎵 오디오 플레이어</h2>
                    </div>
                    <div class="audio-player-wrapper">
                        <audio id="audioPlayer" controls style="width: 100%;">
                            Your browser does not support the audio element.
                        </audio>
                    </div>
                    <div class="volume-control">
                        <label for="audioVolume">🔊 오디오 볼륨:</label>
                        <input type="range" id="audioVolume" min="0" max="100" value="80" class="volume-slider">
                        <span id="audioVolumeValue">80%</span>
                    </div>
                </div>

                <!-- 제목 입력 영역 -->
                <div class="audio-player-container" style="margin-top: 10px;">
                    <label for="audioTitleInput" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">
                        📝 제목 입력 (회의록과 요약을 VectorStore에 저장할 때 메타데이터로 추가됩니다)
                    </label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input
                            type="text"
                            id="audioTitleInput"
                            placeholder="회의록 제목을 입력하세요..."
                            style="flex: 1; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem;"
                        >
                        <button id="saveAudioTitleBtn" class="btn-primary" style="flex: 0 0 auto; width: auto !important; padding: 10px 16px; white-space: nowrap; font-size: 0.9rem;">
                            저장
                        </button>
                    </div>
                    <div id="audioTitleStatus" style="margin-top: 8px; font-size: 0.9rem;"></div>
                </div>

                <!-- 오디오 전용 레이아웃: 요약/채팅 (왼쪽) | 회의록 (오른쪽) -->
                <div class="audio-viewer-layout">
                    <!-- 왼쪽: 요약 + 채팅 -->
                    <div class="audio-left-section">
                        <!-- 요약 섹션 -->
                        <div class="summary-container">
                            <div class="summary-header">
                                <h2>📋 소주제별 요약</h2>
                                <button id="audioGenerateSummaryBtn" class="btn-primary">요약 생성</button>
                            </div>
                            <div id="audioSummaryContent" class="summary-content">
                                <p class="summary-placeholder">요약 생성 버튼을 클릭하세요</p>
                            </div>
                            <div id="audioSummaryLoading" class="loading-indicator" style="display: none;">
                                <span class="spinner"></span> 요약 생성 중...
                            </div>
                        </div>

                        <!-- 채팅 섹션 -->
                        <div class="chat-container">
                            <div class="chat-header">
                                <h2>💬 AI 채팅</h2>
                                <button id="audioClearChatBtn" class="btn-clear-chat" title="대화 초기화">🗑️</button>
                            </div>
                            <div id="audioChatMessages" class="chat-messages">
                                <div class="chat-welcome">
                                    회의록 내용에 대해 질문해보세요!
                                </div>
                            </div>
                            <div class="chat-input-container">
                                <textarea
                                    id="audioChatInput"
                                    class="chat-input"
                                    placeholder="질문을 입력하세요..."
                                    rows="2"
                                ></textarea>
                                <button id="audioSendChatBtn" class="btn-send-chat">
                                    <img src="{{ url_for('static', filename='images/chat_icon.png') }}?v=2" alt="Send" class="btn-icon-img">
                                </button>
                            </div>
                            <div id="audioChatLoading" class="loading-indicator" style="display: none;">
                                <span class="spinner"></span> 응답 생성 중...
                            </div>
                        </div>
                    </div>

                    <!-- 오른쪽: 회의록 -->
                    <div class="transcript-container">
                        <div class="transcript-header">
                            <h2>📝 회의록</h2>
                            <div class="controls" style="flex-direction: column; align-items: flex-start; gap: 8px;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span id="audioOriginalLanguage" style="padding: 6px 12px; background: rgba(var(--primary-rgb), 0.1); border-radius: 6px; font-size: 0.9rem; color: var(--primary-color); font-weight: 600;"></span>
                                    <select id="audioLanguageSelect" class="language-select" style="padding: 8px 12px; border-radius: 6px; border: 2px solid var(--border-color); background: var(--bg-primary); color: var(--text-primary);">
                                        <option value="original">원본</option>
                                        <option value="en">English</option>
                                        <option value="ja">日本語</option>
                                        <option value="de">Deutsch</option>
                                        <option value="ko">한국어</option>
                                    </select>
                                    <button id="audioTranslateBtn" class="btn-secondary" style="padding: 8px 16px;">번역</button>
                                    <button id="audioGenerateTtsBtn" class="btn-primary" style="padding: 8px 16px;">오디오 생성</button>
                                </div>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <button id="audioAutoScrollToggle" class="btn-secondary active">자동 스크롤: ON</button>
                                    <span id="audioSegmentInfo" style="font-size: 0.9rem; color: var(--text-secondary);">총 0개 세그먼트</span>
                                </div>
                            </div>
                        </div>
                        <div id="audioTranscriptContent" class="transcript-content"></div>
                    </div>
                </div>

                <!-- VectorStore 저장 버튼 -->
                <div class="audio-player-container" style="margin-top: 20px;">
                    <div style="text-align: center; padding: 20px; background: var(--bg-secondary); border-radius: 12px; border: 2px solid var(--primary-color);">
                        <h3 style="margin-bottom: 16px; color: var(--primary-color);">📦 VectorStore 저장</h3>
                        <p style="margin-bottom: 16px; color: var(--text-muted); font-size: 0.9rem;">
                            제목과 요약을 입력한 후 아래 버튼을 클릭하여 VectorStore에 저장하세요.
                        </p>
                        <button id="saveAudioToVectorstoreBtn" class="btn-primary" style="padding: 16px 32px; font-size: 1.1rem;">
                            💾 VectorStore에 저장
                        </button>
                        <div id="audioVectorstoreSaveStatus" style="margin-top: 12px; font-size: 0.9rem;"></div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ========== Retriever 검색 탭 ========== -->
        <div id="retriever-tab" class="tab-content">
            <!-- Retriever 검색 섹션 -->
            <section class="upload-section">
                <div class="upload-card">
                    <h2>🔍 VectorStore 검색</h2>
                    <p class="description">YouTube 및 오디오 VectorStore에서 관련 회의록을 검색합니다</p>

                    <form id="retrieverForm">
                        <div class="form-group">
                            <label for="retrieverQuery">검색어</label>
                            <input
                                type="text"
                                id="retrieverQuery"
                                name="query"
                                placeholder="검색할 내용을 입력하세요..."
                                required
                                style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem;"
                            >
                        </div>

                        <div class="form-group">
                            <label>검색 대상 선택</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="source_type" value="all" checked>
                                    <span class="radio-text">
                                        <strong>전체 검색</strong>
                                        <small>YouTube + Audio 모두 검색</small>
                                    </span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="source_type" value="summary">
                                    <span class="radio-text">
                                        <strong>요약 검색</strong>
                                        <small>회의 요약만 검색</small>
                                    </span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="retrieverResults">검색 결과 수</label>
                            <select id="retrieverResults" name="n_results" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem;">
                                <option value="1">1개</option>
                                <option value="2">2개</option>
                                <option value="5" selected>5개</option>
                                <option value="10">10개</option>
                                <option value="15">15개</option>
                                <option value="20">20개</option>
                            </select>
                        </div>

                        <button type="submit" class="btn-primary">
                            <span class="btn-icon">🔍</span>
                            검색
                        </button>
                    </form>

                    <div id="retrieverStatus" class="upload-status"></div>
                </div>
            </section>

            <!-- 검색 결과 섹션 -->
            <section class="viewer-section" id="retrieverResultsSection" style="display: none;">
                <!-- 플레이어 영역 -->
                <div id="retrieverPlayerSection" style="display: none; margin-bottom: 20px;">
                    <div class="audio-player-container">
                        <div class="audio-header">
                            <h2 id="retrieverPlayerTitle">🎵 플레이어</h2>
                            <button id="retrieverClosePlayerBtn" class="btn-secondary" style="padding: 8px 16px;">
                                ✕ 닫기
                            </button>
                        </div>

                        <!-- YouTube 플레이어 -->
                        <div id="retrieverYoutubePlayerWrapper" style="display: none;">
                            <div id="retrieverYoutubePlayer"></div>
                            <div class="player-info" style="margin-top: 10px;">
                                <span id="retrieverVideoCurrentTime">00:00</span> / <span id="retrieverVideoDuration">00:00</span>
                            </div>
                        </div>

                        <!-- 오디오 플레이어 -->
                        <div id="retrieverAudioPlayerWrapper" class="audio-player-wrapper" style="display: none;">
                            <audio id="retrieverAudioPlayer" controls style="width: 100%;">
                                Your browser does not support the audio element.
                            </audio>
                        </div>
                    </div>
                </div>

                <div class="transcript-container" style="max-height: none; height: auto;">
                    <div class="transcript-header">
                        <h2>📊 검색 결과</h2>
                        <div class="controls">
                            <span id="retrieverResultInfo">검색 결과: 0개</span>
                        </div>
                    </div>
                    <div id="retrieverResultsContent" class="transcript-content" style="max-height: none; height: auto; min-height: 400px;">
                        <!-- 검색 결과가 여기에 표시됩니다 -->
                    </div>
                </div>
            </section>
        </div>

        <!-- ========== 내용 질문 탭 ========== -->
        <div id="ask-content-tab" class="tab-content">
            <!-- 질문 입력 섹션 -->
            <section class="upload-section">
                <div class="upload-card">
                    <h2>💬 내용 질문 (RAG)</h2>
                    <p class="description">VectorStore에서 관련 내용을 검색하여 AI가 답변합니다</p>

                    <form id="askContentForm">
                        <div class="form-group">
                            <label for="contentQuestion">질문</label>
                            <textarea
                                id="contentQuestion"
                                name="question"
                                placeholder="회의록 내용에 대해 질문하세요..."
                                required
                                style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem; min-height: 100px; resize: vertical;"
                            ></textarea>
                        </div>

                        <div class="form-group">
                            <label>검색 설정</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div>
                                    <label for="transcriptCount" style="font-size: 0.9rem; color: var(--text-secondary);">
                                        전체 검색 개수
                                    </label>
                                    <select id="transcriptCount" name="transcript_n" style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem; margin-top: 5px;">
                                        <option value="1">1개</option>
                                        <option value="2">2개</option>
                                        <option value="3">3개</option>
                                        <option value="5" selected>5개</option>
                                        <option value="10">10개</option>
                                    </select>
                                    <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                                        회의록 전체에서 검색
                                    </small>
                                </div>
                                <div>
                                    <label for="summaryCount" style="font-size: 0.9rem; color: var(--text-secondary);">
                                        요약 검색 개수
                                    </label>
                                    <select id="summaryCount" name="summary_n" style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1rem; margin-top: 5px;">
                                        <option value="1">1개</option>
                                        <option value="2">2개</option>
                                        <option value="3">3개</option>
                                        <option value="5" selected>5개</option>
                                        <option value="10">10개</option>
                                    </select>
                                    <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                                        회의 요약에서 검색
                                    </small>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="btn-primary" id="askContentBtn">
                            <span class="btn-icon">💬</span>
                            <span id="askContentBtnText">질문하기</span>
                        </button>
                    </form>

                    <div id="askContentStatus" class="upload-status"></div>
                </div>
            </section>

            <!-- 답변 표시 섹션 -->
            <section class="viewer-section" id="askContentAnswerSection" style="display: none;">
                <div class="transcript-box">
                    <div class="transcript-header">
                        <h2>💡 답변</h2>
                        <div class="controls">
                            <span id="askContentResultInfo">검색: 전체 0개, 요약 0개</span>
                        </div>
                    </div>
                    <div id="askContentAnswer" class="transcript-content markdown-content" style="max-height: none; height: auto; min-height: 300px; line-height: 1.8; padding: 20px;">
                        <!-- 답변이 여기에 표시됩니다 -->
                    </div>
                </div>

                <!-- 검색된 컨텍스트 표시 (접을 수 있음) -->
                <details style="margin-top: 20px;" open>
                    <summary style="cursor: pointer; font-weight: bold; padding: 10px; background: var(--card-bg); border-radius: 8px; margin-bottom: 10px;">
                        📚 참고한 검색 결과
                    </summary>

                    <!-- 요약 검색 결과 (먼저 표시) -->
                    <div style="margin-bottom: 20px;">
                        <h3 style="font-size: 1.1rem; margin-bottom: 10px;">📝 요약 검색 결과</h3>
                        <div id="askContentSummaryResults" class="transcript-content" style="max-height: 400px; overflow-y: auto;">
                            <!-- 요약 검색 결과가 여기에 표시됩니다 -->
                        </div>
                    </div>

                    <!-- Chunk 검색 결과 (회의록 전체에서 검색) -->
                    <div>
                        <h3 style="font-size: 1.1rem; margin-bottom: 10px;">🔍 Chunk 검색 결과 (회의록 전체에서 검색)</h3>
                        <div id="askContentTranscriptResults" class="transcript-content" style="max-height: 400px; overflow-y: auto;">
                            <!-- Chunk 검색 결과가 여기에 표시됩니다 -->
                        </div>
                    </div>
                </details>
            </section>
        </div>

        <!-- ========== 데이터 관리 탭 ========== -->
        <div id="data-management-tab" class="tab-content">
            <!-- 통계 섹션 -->
            <section class="upload-section">
                <div class="upload-card">
                    <h2>📊 데이터베이스 통계</h2>
                    <div id="dbStats" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px;">
                        <!-- 통계 로드 중... -->
                    </div>
                    <button onclick="loadDataList()" class="btn-primary" style="margin-top: 20px;">
                        🔄 새로고침
                    </button>
                </div>
            </section>

            <!-- 목록 섹션 -->
            <section class="viewer-section">
                <div class="transcript-box">
                    <div class="transcript-header">
                        <h2>📹 YouTube 영상 목록</h2>
                    </div>
                    <div id="youtubeList" class="transcript-content" style="max-height: 400px;">
                        <p style="text-align: center; color: var(--text-muted);">로딩 중...</p>
                    </div>
                </div>

                <div class="transcript-box" style="margin-top: 20px;">
                    <div class="transcript-header">
                        <h2>🎵 오디오 파일 목록</h2>
                    </div>
                    <div id="audioList" class="transcript-content" style="max-height: 400px;">
                        <p style="text-align: center; color: var(--text-muted);">로딩 중...</p>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Application JavaScript -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
